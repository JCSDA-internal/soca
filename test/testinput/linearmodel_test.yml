---
test_framework_runtime_config: "--log_level=test_suite"
Geometry:
  num_ice_cat: 5
  num_ice_lev: 4
  num_sno_lev: 1
Model:
  name: SOCA
  tstep: PT1H
Variables:
  variables:
  - cicen
  - hicen
  - hsnon
  - tsfcn
  - qsnon
  - sicnk
  - qicnk
  - socn
  - tocn
  - ssh
  - hocn
ModelBias: 
  covariance: SocaError
State:
  read_from_file: 1
  basename: "./INPUT/"
  ocn_sfc_filename: MOM.res.nc
  ocn_filename: MOM.res.nc
  ice_filename: ice_model.res.nc
  date: '2018-04-15T00:00:00Z'
LinearModel:
  name:
  version: IdTLM
  tstep: PT1H
LinearModelTest:
  fclength: PT2H
  testiterTL: 1
  toleranceTL: 1.0e-6
  toleranceAD: 1.0e-12
Covariance:
  covariance: SocaError #BUMP
  # General parameters
  default_seed: 1
  prefix: soca
  datadir: ./bump
  # Driver parameters
  method: cor
  #strategy: specific_univariate
  strategy: common  
#  new_hdiag: 0
  new_nicas: 0   # 1: recomputes convol param
  load_nicas: 1  # 1: loads convol param (layout specific)
  # Sampling parameters
  sam_read: 0
  sam_write: 1  
  mask_check: 1
  draw_type: random_uniform
  nc1: 100
  ntry: 3
  nrep:  2
  nc3: 10
  dc: 1000.0e3
  nl0r: 1
  # Diag parameters
  # Fit parameters
  minim_algo: "hooke"
  rvflt: 0.0
  # NICAS parameters
  lsqrt: 1  
  resol: 8.0
  nicas_interp: bilin
  network: 1
  mpicom: 2 # Number of internal comm steps 
  #NICAS parameters
  forced_radii: 1
  rh: 3000e3
  rv: 100
  advmode: 0
  # Output parameters  
  diag_interp: bilin
  date: '2018-04-15T00:00:00Z'
cost_function:
  cost_type: 3D-Var
  window_begin: '2018-04-15T00:00:00Z'
  window_length: PT6H
  variables:
  - cicen
  - hicen
  - hsnon
  - tsfcn
  - qsnon
  - sicnk
  - qicnk
  - socn
  - tocn
  - ssh
  Jb:
    Background:
      state:
      - read_from_file: 1
        basename: "./INPUT/"
        ocn_sfc_filename: MOM.res.nc
        ocn_filename: MOM.res.nc
        ice_filename: ice_model.res.nc
        date: '2018-04-15T00:00:00Z'
    Covariance:
      covariance: SocaError #BUMP
      # General parameters
      default_seed: 1
      prefix: soca
      datadir: ./bump
      # Driver parameters
      method: cor
      #strategy: specific_univariate
      strategy: common      
#      new_hdiag: 0
      new_nicas: 0       # 1: recomputes convol param
      load_nicas: 1      # 1: loads convol param (layout specific)
      # Sampling parameters
      sam_read: 0
      sam_write: 1      
      mask_check: 1
      draw_type: random_uniform
      nc1: 100
      ntry: 3
      nrep:      2
      nc3: 10
      dc: 1000.0e3
      nl0r: 1
      # Diag parameters
      # Fit parameters
      minim_algo: "hooke"
      rvflt: 0.0
      # NICAS parameters
      lsqrt: 1      
      resol: 8.0
      nicas_interp: bilin
      network: 1
      mpicom: 2 # Number of internal comm steps 
      #NICAS parameters
      forced_radii: 1
      rh: 3000e3
      rv: 100
      advmode: 0
      # Output parameters      
      diag_interp: bilin
      date: '2018-04-15T00:00:00Z'                  
  Jo:
    ObsTypes:
    - ObsType: ADT
      ObsData:
        ObsDataOut:
          obsfile: Data/test_obsout.nc
        ObsDataIn:
          obsfile: Data/Jason-2-2018-04-15.nc
        obsvalue: ObsVal        
      Covariance:
        covariance: diagonal
        obserror: ObsErr        
variational:
  iteration:
  - resolution: {}
    linearmodel:
      version: IdTLM
      tstep: PT1H
    ninner: 1
    gradient_norm_reduction: 1e-8
    test: 'on'
minimizer:
  algorithm: DRIPCG
output:
  first: PT3H
  frequency: PT06H
  datadir: Data
  exp: 3dvar
  type: an
final:
  diagnostics:
    departures: oman
prints:
  frequency: PT3H
